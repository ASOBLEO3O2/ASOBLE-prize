<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DB Dashboard</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar__left">
      <div class="title">
        <div class="title__main">DB Dashboard</div>
        <div class="title__sub" id="lastUpdated">更新: -</div>
      </div>
    </div>

    <div class="topbar__center">
      <div class="chiprow" id="activeFilterChips"></div>
    </div>

    <div class="topbar__right">
      <button class="btn" id="openDrawerBtn">フィルタ</button>
      <div class="axisBox">
        <label class="axisBox__label">中段軸</label>
        <select id="axisSelect" class="select"></select>
      </div>
    </div>
  </header>

  <!-- Drawer -->
  <div class="drawerOverlay" id="drawerOverlay"></div>
  <aside class="drawer" id="drawer">
    <div class="drawer__header">
      <div class="drawer__title">フィルタ</div>
      <button class="btn btn--ghost" id="closeDrawerBtn">閉じる</button>
    </div>

    <div class="drawer__section">
      <div class="secTitle">マシン（対応マシン名）</div>
      <input id="machineSearch" class="input" placeholder="例：UFO / ジェミニ / スウィート" />
      <div class="chipgrid" id="machineChipGrid"></div>
      <button class="btn btn--danger w100" id="clearMachinesBtn">マシン解除</button>
    </div>

    <div class="drawer__section">
      <div class="secTitle">投入法</div>
      <div class="seg" id="clawSeg"></div>
    </div>

    <div class="drawer__section">
      <div class="secTitle">カテゴリ（任意）</div>
      <div class="grid2">
        <div>
          <label class="label">景品ジャンル</label>
          <select id="genreSelect" class="select"></select>
        </div>
        <div>
          <label class="label">キャラ</label>
          <select id="charaSelect" class="select"></select>
        </div>
        <div>
          <label class="label">性別</label>
          <select id="genderSelect" class="select"></select>
        </div>
        <div>
          <label class="label">年代</label>
          <select id="ageSelect" class="select"></select>
        </div>
      </div>
    </div>

    <div class="drawer__section">
      <div class="secTitle">条件フィルタ（数値）</div>
      <div class="grid2">
        <div>
          <label class="label">売上 下限</label>
          <input id="minSales" class="input" inputmode="numeric" placeholder="例：10000" />
        </div>
        <div>
          <label class="label">売上 上限</label>
          <input id="maxSales" class="input" inputmode="numeric" placeholder="例：200000" />
        </div>
        <div>
          <label class="label">原価率 下限（%）</label>
          <input id="minCostPct" class="input" inputmode="numeric" placeholder="例：5" />
        </div>
        <div>
          <label class="label">原価率 上限（%）</label>
          <input id="maxCostPct" class="input" inputmode="numeric" placeholder="例：40" />
        </div>
      </div>

      <div class="presetRow">
        <button class="btn btn--ghost" id="presetHighSalesLowCost">売上>1万 かつ 原価率<5%</button>
        <button class="btn btn--ghost" id="presetResetNumeric">条件リセット</button>
      </div>

      <div class="hint">
        ※「原価率」は <b>消化額÷売上</b>（%）で計算。<br />
        ※ 条件は <b>明細（行）</b> に適用しています。
      </div>
    </div>

    <div class="drawer__footer">
      <button class="btn w100" id="applyFiltersBtn">反映</button>
    </div>
  </aside>

  <main class="container">
    <!-- KPI -->
    <section class="kpiRow">
      <div class="card">
        <div class="card__label">売上合計</div>
        <div class="card__value" id="kpiSales">-</div>
        <div class="card__sub" id="kpiMachineCount">台数: -</div>
      </div>
      <div class="card">
        <div class="card__label">消化額合計</div>
        <div class="card__value" id="kpiConsume">-</div>
      </div>
      <div class="card">
        <div class="card__label">原価率</div>
        <div class="card__value" id="kpiCostRate">-</div>
      </div>
      <div class="card">
        <div class="card__label">平均（1台あたり売上）</div>
        <div class="card__value" id="kpiAvg">-</div>
      </div>
    </section>

    <!-- Mid KPI (Axis) -->
    <section class="midRow">
      <div class="midHeader">
        <div class="midTitle">実データ（軸別）</div>

        <div class="midTools">
          <label class="labelInline">並び替え</label>
          <select id="axisSortKey" class="select">
            <option value="sales">売上</option>
            <option value="consume">消化額</option>
            <option value="costRate">原価率</option>
            <option value="machines">台数</option>
          </select>
          <button class="btn btn--ghost" id="axisSortDirBtn" title="昇順/降順">降順</button>
        </div>
      </div>

      <div class="axisCards" id="axisCards"></div>
    </section>

    <!-- Table -->
    <section class="tableCard">
      <div class="tableHeader">
        <div class="tableTitle">実データ（明細）</div>

        <div class="tableTools">
          <label class="labelInline">並び替え</label>
          <select id="tableSortKey" class="select">
            <option value="sales">総売上</option>
            <option value="consumeCount">消化数</option>
            <option value="consume">消化額</option>
            <option value="costRate">原価率</option>
            <option value="updatedAt">更新日時</option>
          </select>
          <button class="btn btn--ghost" id="tableSortDirBtn">降順</button>

          <div class="tableMeta" id="tableMeta">対象: -</div>
        </div>
      </div>

      <div class="tableWrap">
        <table class="table">
          <thead>
            <tr>
              <th data-sort="machine">マシン名</th>
              <th>景品名</th>
              <th class="num" data-sort="sales">総売上</th>
              <th class="num" data-sort="consumeCount">消化数</th>
              <th class="num" data-sort="consume">消化額</th>
              <th class="num" data-sort="costRate">原価率</th>
              <th class="num" data-sort="updatedAt">更新日時</th>
            </tr>
          </thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <script src="./app.js"></script>
</body>
</html>
